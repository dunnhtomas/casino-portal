---
/**
 * TopThree Component - Refactored
 * Single Responsibility: Display top 10 casino recommendations with pagination
 * File length: ~100 lines (was 640)
 */
import { EnhancedCasinoCard } from '../Casino/EnhancedCasinoCard';
import * as HomeVM from '../../viewmodels/HomeVM';
import { TopThreeDataProvider } from '../../services/TopThreeDataProvider';
import { TopThreeViewModel } from '../../viewmodels/TopThreeViewModel';
import { TopThreeSEOManager } from '../../managers/TopThreeSEOManager';

// Initialize services (data already loaded at build time)
const dataProvider = new TopThreeDataProvider();

// Get data (no await needed)
const casinos = dataProvider.getCasinos();
const top10 = HomeVM.getTopThree(casinos, 10);

// Transform data
const viewModel = new TopThreeViewModel();
const enhancedCasinos = top10.map((casino, index) => 
  viewModel.mapCasinoToCardData(casino, index + 1)
);

// Generate SEO data
const seoManager = new TopThreeSEOManager();
const jsonLd = seoManager.generateJsonLd(enhancedCasinos);
---

<section 
  id="top-three" 
  class="py-12 sm:py-16 lg:py-20 bg-gradient-to-br from-gray-900 to-gray-800"
  role="region"
  aria-labelledby="top-casinos-heading"
>
  <script type="application/ld+json" set:html={JSON.stringify(jsonLd)}></script>
  
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <header class="text-center mb-8 sm:mb-12 lg:mb-16">
      <h2 id="top-casinos-heading" class="text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold text-white mb-3 sm:mb-4 lg:mb-6 leading-tight" data-aos="fade-up">
        üèÜ Top 10 Casino Recommendations
      </h2>
      <p class="text-base sm:text-lg lg:text-xl text-gray-300 max-w-2xl lg:max-w-3xl xl:max-w-4xl mx-auto leading-relaxed px-4 sm:px-0" data-aos="fade-up" data-aos-delay="200">
        Our highest-rated casinos based on expert analysis and player reviews
      </p>
      <div class="w-16 sm:w-20 lg:w-24 h-1 bg-gradient-to-r from-gold-400 to-gold-600 mx-auto mt-3 sm:mt-4 lg:mt-6 rounded" data-aos="fade-up" data-aos-delay="400" aria-hidden="true"></div>
    </header>
    
    <div id="casino-grid-container" class="max-w-[1400px] mx-auto">
      <!-- Professional 3-column grid layout -->
      <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6 lg:gap-8 xl:gap-10">
        {enhancedCasinos.map((casino, index) => (
          <article 
            class="casino-card-enhanced group flex flex-col h-full" 
            data-casino={casino.slug}
            data-aos="fade-up"
            data-aos-delay={index * 50}
          >
            <EnhancedCasinoCard 
              casino={casino}
              variant={index === 0 ? 'featured' : 'default'}
              rank={index + 1}
              client:visible={index > 2}
              client:load={index <= 2}
            />
          </article>
        ))}
      </div>
      
      <div class="mt-12 sm:mt-16 text-center">
        <div class="bg-gradient-to-r from-gray-800/50 to-gray-700/50 backdrop-blur-sm rounded-2xl p-6 sm:p-8 border border-gray-700/50 shadow-xl max-w-2xl mx-auto">
          <p class="text-gray-300 mb-6 text-base sm:text-lg font-medium">
            <span class="text-gold-400 font-bold text-2xl">79</span> expertly reviewed casinos
          </p>
          <a 
            href="/best" 
            class="inline-flex items-center gap-3 bg-gradient-to-r from-gold-500 via-gold-600 to-amber-600 hover:from-gold-600 hover:via-gold-700 hover:to-amber-700 text-white font-bold text-base sm:text-lg px-10 sm:px-14 py-4 sm:py-5 rounded-xl shadow-2xl hover:shadow-gold-500/25 transform hover:-translate-y-1 hover:scale-105 transition-all duration-300 group relative overflow-hidden"
            data-aos="fade-up"
            data-aos-delay="400"
          >
            <span class="absolute inset-0 bg-gradient-to-r from-white/0 via-white/10 to-white/0 transform -translate-x-full group-hover:translate-x-full transition-transform duration-700"></span>
            <span class="relative flex items-center gap-3">
              <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                <path d="M10 3.5a1.5 1.5 0 013 0V4a1 1 0 001 1h3a1 1 0 011 1v3a1 1 0 01-1 1h-.5a1.5 1.5 0 000 3h.5a1 1 0 011 1v3a1 1 0 01-1 1h-3a1 1 0 01-1-1v-.5a1.5 1.5 0 00-3 0v.5a1 1 0 01-1 1H6a1 1 0 01-1-1v-3a1 1 0 00-1-1h-.5a1.5 1.5 0 010-3H4a1 1 0 001-1V6a1 1 0 011-1h3a1 1 0 001-1v-.5z"></path>
              </svg>
              <span>Explore All Casinos</span>
              <svg class="w-5 h-5 transform group-hover:translate-x-2 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
              </svg>
            </span>
          </a>
          <p class="text-xs sm:text-sm text-gray-400 mt-4">Updated daily with the latest offers</p>
        </div>
      </div>
    </div>
    
    <footer class="mt-12 sm:mt-16 lg:mt-20 text-center">
      <p class="text-base sm:text-lg text-gray-300 mb-4 sm:mb-6 px-4 sm:px-0" data-aos="fade-up" data-aos-delay="600">
        üéØ Our recommendations are based on rigorous testing and expert analysis
      </p>
      <div class="flex flex-wrap justify-center gap-2 sm:gap-3 lg:gap-4 text-xs sm:text-sm text-gray-400 px-4 sm:px-0" data-aos="fade-up" data-aos-delay="800">
        <span class="bg-gray-800 px-3 sm:px-4 py-2 rounded-full shadow-sm whitespace-nowrap border border-gray-700">‚úÖ Licensed & Regulated</span>
        <span class="bg-gray-800 px-3 sm:px-4 py-2 rounded-full shadow-sm whitespace-nowrap border border-gray-700">üõ°Ô∏è SSL Secured</span>
        <span class="bg-gray-800 px-3 sm:px-4 py-2 rounded-full shadow-sm whitespace-nowrap border border-gray-700">‚ö° Fast Payouts</span>
        <span class="bg-gray-800 px-3 sm:px-4 py-2 rounded-full shadow-sm whitespace-nowrap border border-gray-700">üéÆ Premium Games</span>
      </div>
    </footer>
  </div>
</section>

<style>
  /* Professional 3-column grid styling */
  .casino-card-enhanced { 
    will-change: transform; 
    text-rendering: optimizeLegibility; 
    contain: layout style paint; 
    min-height: 400px; 
    display: flex; 
    flex-direction: column;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  #casino-grid-container .grid { 
    align-items: stretch; 
  }
  
  /* Smooth hover effects */
  @media (hover: hover) and (pointer: fine) {
    .casino-card-enhanced:hover { 
      transform: translateY(-8px) scale(1.02);
      z-index: 10;
    }
  }
  
  /* Touch device optimizations */
  @media (pointer: coarse) {
    .casino-card-enhanced { 
      transform: none !important; 
      min-height: 380px;
    }
  }
  
  /* Reduced motion support */
  @media (prefers-reduced-motion: reduce) {
    .casino-card-enhanced { 
      transition: none !important; 
      transform: none !important; 
    }
    [data-aos] { 
      animation: none !important; 
    }
  }
  
  /* Responsive grid adjustments */
  @media (min-width: 1024px) and (max-width: 1279px) {
    #casino-grid-container .grid {
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }
  }
  
  @media (min-width: 1280px) {
    #casino-grid-container .grid {
      grid-template-columns: repeat(3, minmax(0, 1fr));
    }
  }
</style>
