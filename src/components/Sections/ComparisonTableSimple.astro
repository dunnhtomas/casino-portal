---
/**
 * ComparisonTableSimple Component
 * Single Responsibility: Display casino comparison table using ViewModel
 */

import { ComparisonTableViewModel } from '../../viewmodels/components/ComparisonTableViewModel';
import ComparisonTableRow from './ComparisonTableRow.astro';

// Initialize ViewModel
const viewModel = new ComparisonTableViewModel();
viewModel.initialize({ limit: 8 });
const componentData = await viewModel.getDisplayData();
const { displayProps } = componentData;

// Type assertion for better TypeScript support
const tableData = displayProps.tableData as Array<{
  rank: number;
  casino: { name: string; slug: string; logo?: string; domain: string; };
  rating: { overall: number; display: string; tier: string; ratingData: any; };
  bonus: { display: string; amount?: string; highlight: boolean; wagering?: string; };
  payout: string;
  cta: { text: string; href: string; variant: string; };
  styling: { badgeClass: string; rowClass: string; isTopRank: boolean; };
  isTop3: boolean;
}>;
---

<section id="comparison-table" class="py-16 bg-gradient-to-br from-gray-900 to-gray-800">
  <div class="max-w-7xl mx-auto px-4 lg:px-6 w-full">
    <!-- Section Header -->
    <div class="text-center mb-12">
      <h2 class="text-4xl font-bold text-white mb-4">🏅 Compare Top Online Casinos</h2>
      <p class="text-xl text-gray-300">Our highest-rated casino sites ranked by expert analysis</p>
      <div class="w-24 h-1 bg-gradient-to-r from-primary-400 to-primary-600 mx-auto mt-4 rounded"></div>
    </div>

    <!-- Comparison Table -->
    <div class="w-full overflow-x-auto bg-gray-800 rounded-2xl shadow-xl border border-gray-700 smooth-scroll">
      <table class="w-full max-w-sm sm:max-w-none table-fixed sm:table-auto">
        <thead class="bg-gradient-to-r from-gray-700 to-gray-600 border-b-2 border-gray-600">
          <tr>
            <th class="text-left py-4 px-2 lg:py-6 lg:px-6 font-bold text-white text-sm lg:text-base w-12 sm:w-auto">🏆 Rank</th>
            <th class="text-left py-4 px-2 lg:py-6 lg:px-6 font-bold text-white text-sm lg:text-base w-20 sm:w-auto sm:min-w-[180px]">🎰 Casino</th>
            <th class="text-center py-4 px-1 lg:py-6 lg:px-4 font-bold text-white text-sm lg:text-base w-12 sm:w-auto">⭐ Rating</th>
            <th class="text-center py-4 px-1 lg:py-6 lg:px-4 font-bold text-white text-sm lg:text-base w-14 sm:w-auto">⚡ Payout</th>
            <th class="text-center py-4 px-1 lg:py-6 lg:px-4 font-bold text-white text-sm lg:text-base w-16 sm:w-auto sm:min-w-[120px]">💰 Bonus</th>
            <th class="text-center py-4 px-2 lg:py-6 lg:px-6 font-bold text-white text-sm lg:text-base w-16 sm:w-auto">🎯 Action</th>
          </tr>
        </thead>
        <tbody>
          {tableData.map(rowData => 
            <ComparisonTableRow rowData={rowData} />
          )}
        </tbody>
      </table>
    </div>

    <!-- Last Updated Info -->
    <div class="text-center mt-6">
      <p class="text-sm text-gray-500">
        Last updated: {new Date().toLocaleDateString()}
      </p>
    </div>
  </div>
</section>